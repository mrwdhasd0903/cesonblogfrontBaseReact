/*!
 * wordcloud2.js
 * http://timdream.org/wordcloud2.js/
 *
 * Copyright 2011 - 2019 Tim Guan-tin Chien and contributors.
 * Released under the MIT license
 */
"use strict";if(!window.setImmediate){window.setImmediate=(function setupSetImmediate(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||(function a(){if(!window.postMessage||!window.addEventListener){return null}var f=[undefined];var e="zero-timeout-message";var d=function d(i){var h=f.length;f.push(i);window.postMessage(e+h.toString(36),"*");return h};window.addEventListener("message",function g(h){if(typeof h.data!=="string"||h.data.substr(0,e.length)!==e){return}h.stopImmediatePropagation();var i=parseInt(h.data.substr(e.length),36);if(!f[i]){return}f[i]();f[i]=undefined},true);window.clearImmediate=function c(h){if(!f[h]){return}f[h]=undefined};return d})()||function b(c){window.setTimeout(c,0)}})()}if(!window.clearImmediate){window.clearImmediate=(function setupClearImmediate(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function a(b){window.clearTimeout(b)}})()}(function(b){var c=(function c(){var k=document.createElement("canvas");if(!k||!k.getContext){return false}var j=k.getContext("2d");if(!j){return false}if(!j.getImageData){return false}if(!j.fillText){return false}if(!Array.prototype.some){return false}if(!Array.prototype.push){return false}return true}());var h=(function i(){if(!c){return}var j=document.createElement("canvas").getContext("2d");var l=20;var m,k;while(l){j.font=l.toString(10)+"px sans-serif";if((j.measureText("\uFF37").width===m)&&(j.measureText("m").width)===k){return(l+1)}m=j.measureText("\uFF37").width;k=j.measureText("m").width;l--}return 0})();var f=function(k){if(Array.isArray(k)){var j=k.slice();j.splice(0,2);return j}else{return[]}};var e=function e(l){for(var m,k,n=l.length;n;){m=Math.floor(Math.random()*n);k=l[--n];l[n]=l[m];l[m]=k}return l};var a={};var d=function d(m,C){if(!c){return}var l=Math.floor(Math.random()*Date.now());if(!Array.isArray(m)){m=[m]}m.forEach(function(ag,af){if(typeof ag==="string"){m[af]=document.getElementById(ag);if(!m[af]){throw new Error("The element id specified is not found.")}}else{if(!ag.tagName&&!ag.appendChild){throw new Error("You must pass valid HTML elements, or ID of the element.")}}});var ab={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", '+'"Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:true,backgroundColor:"#fff",gridSize:8,drawOutOfBound:false,shrinkToFit:false,origin:null,drawMask:false,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:0.3,wait:0,abortThreshold:0,abort:function aa(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:true,rotateRatio:0.1,shape:"circle",ellipticity:0.65,classes:null,hover:null,click:null};if(C){for(var x in C){if(x in ab){ab[x]=C[x]}}}if(typeof ab.weightFactor!=="function"){var Y=ab.weightFactor;ab.weightFactor=function Q(af){return af*Y}}if(typeof ab.shape!=="function"){switch(ab.shape){case"circle":default:ab.shape="circle";break;case"cardioid":ab.shape=function s(af){return 1-Math.sin(af)};break;case"diamond":ab.shape=function O(af){var ag=af%(2*Math.PI/4);return 1/(Math.cos(ag)+Math.sin(ag))};break;case"square":ab.shape=function O(af){return Math.min(1/Math.abs(Math.cos(af)),1/Math.abs(Math.sin(af)))};break;case"triangle-forward":ab.shape=function R(af){var ag=af%(2*Math.PI/3);return 1/(Math.cos(ag)+Math.sqrt(3)*Math.sin(ag))};break;case"triangle":case"triangle-upright":ab.shape=function R(af){var ag=(af+Math.PI*3/2)%(2*Math.PI/3);return 1/(Math.cos(ag)+Math.sqrt(3)*Math.sin(ag))};break;case"pentagon":ab.shape=function u(af){var ag=(af+0.955)%(2*Math.PI/5);return 1/(Math.cos(ag)+0.726543*Math.sin(ag))};break;case"star":ab.shape=function t(af){var ag=(af+0.955)%(2*Math.PI/10);if((af+0.955)%(2*Math.PI/5)-(2*Math.PI/10)>=0){return 1/(Math.cos((2*Math.PI/10)-ag)+3.07768*Math.sin((2*Math.PI/10)-ag))}else{return 1/(Math.cos(ag)+3.07768*Math.sin(ag))}};break}}ab.gridSize=Math.max(Math.floor(ab.gridSize),4);var ac=ab.gridSize;var V=ac-ab.maskGapWidth;var r=Math.abs(ab.maxRotation-ab.minRotation);var P=Math.abs(Math.floor(ab.rotationSteps));var w=Math.min(ab.maxRotation,ab.minRotation);var T,z,y,k,N;var U;var X;function I(ag,af){return"hsl("+(Math.random()*360).toFixed()+","+(Math.random()*30+70).toFixed()+"%,"+(Math.random()*(af-ag)+ag).toFixed()+"%)"}switch(ab.color){case"random-dark":X=function L(){return I(10,50)};break;case"random-light":X=function ae(){return I(50,90)};break;default:if(typeof ab.color==="function"){X=ab.color}break}var M;if(typeof ab.fontWeight==="function"){M=ab.fontWeight}var v=null;if(typeof ab.classes==="function"){v=ab.classes}var o=false;var A=[];var G;var Z=function Z(an){var aj=an.currentTarget;var al=aj.getBoundingClientRect();var ai;var ag;if(an.touches){ai=an.touches[0].clientX;ag=an.touches[0].clientY
}else{ai=an.clientX;ag=an.clientY}var ah=ai-al.left;var af=ag-al.top;var am=Math.floor(ah*((aj.width/al.width)||1)/ac);var ak=Math.floor(af*((aj.height/al.height)||1)/ac);if(A[am]){return A[am][ak]}};var n=function n(af){var ag=Z(af);if(G===ag){return}G=ag;if(!ag){ab.hover(undefined,undefined,af);return}ab.hover(ag.item,ag.dimension,af)};var E=function E(af){var ag=Z(af);if(!ag){return}ab.click(ag.item,ag.dimension,af);af.preventDefault()};var W=[];var S=function S(af){if(W[af]){return W[af]}var ag=af*8;var ah=ag;var ai=[];if(af===0){ai.push([k[0],k[1],0])}while(ah--){var aj=1;if(ab.shape!=="circle"){aj=ab.shape(ah/ag*2*Math.PI)}ai.push([k[0]+af*aj*Math.cos(-ah/ag*2*Math.PI),k[1]+af*aj*Math.sin(-ah/ag*2*Math.PI)*ab.ellipticity,ah/ag*2*Math.PI])}W[af]=ai;return ai};var K=function K(){return((ab.abortThreshold>0)&&((new Date()).getTime()-U>ab.abortThreshold))};var B=function B(){if(ab.rotateRatio===0){return 0}if(Math.random()>ab.rotateRatio){return 0}if(r===0){return w}if(P>0){return w+Math.floor(Math.random()*P)*r/(P-1)}else{return w+Math.random()*r}};var q=function q(aH,aw,ax,aq){var aC=false;var af=ab.weightFactor(aw);if(af<=ab.minSize){return false}var aE=1;if(af<h){aE=(function aj(){var aK=2;while(aK*af<h){aK+=2}return aK})()}var av;if(M){av=M(aH,aw,af,aq)}else{av=ab.fontWeight}var aB=document.createElement("canvas");var aI=aB.getContext("2d",{willReadFrequently:true});aI.font=av+" "+(af*aE).toString(10)+"px "+ab.fontFamily;var ag=aI.measureText(aH).width/aE;var au=Math.max(af*aE,aI.measureText("m").width,aI.measureText("\uFF37").width)/aE;var ao=ag+au*2;var am=au*3;var aJ=Math.ceil(ao/ac);var ah=Math.ceil(am/ac);ao=aJ*ac;am=ah*ac;var aA=-ag/2;var ay=-au*0.4;var aD=Math.ceil((ao*Math.abs(Math.sin(ax))+am*Math.abs(Math.cos(ax)))/ac);var ai=Math.ceil((ao*Math.abs(Math.cos(ax))+am*Math.abs(Math.sin(ax)))/ac);var aF=ai*ac;var az=aD*ac;aB.setAttribute("width",aF);aB.setAttribute("height",az);if(aC){document.body.appendChild(aB);aI.save()}aI.scale(1/aE,1/aE);aI.translate(aF*aE/2,az*aE/2);aI.rotate(-ax);aI.font=av+" "+(af*aE).toString(10)+"px "+ab.fontFamily;aI.fillStyle="#000";aI.textBaseline="middle";aI.fillText(aH,aA*aE,(ay+af*0.5)*aE);var aG=aI.getImageData(0,0,aF,az).data;if(K()){return false}if(aC){aI.strokeRect(aA*aE,ay,ag*aE,au*aE);aI.restore()}var al=[];var at=ai;var ar,ap,an;var ak=[aD/2,ai/2,aD/2,ai/2];while(at--){ar=aD;while(ar--){an=ac;singleGridLoop:while(an--){ap=ac;while(ap--){if(aG[((ar*ac+an)*aF+(at*ac+ap))*4+3]){al.push([at,ar]);if(at<ak[3]){ak[3]=at}if(at>ak[1]){ak[1]=at}if(ar<ak[0]){ak[0]=ar}if(ar>ak[2]){ak[2]=ar}if(aC){aI.fillStyle="rgba(255, 0, 0, 0.5)";aI.fillRect(at*ac,ar*ac,ac-0.5,ac-0.5)}break singleGridLoop}}}if(aC){aI.fillStyle="rgba(0, 0, 255, 0.5)";aI.fillRect(at*ac,ar*ac,ac-0.5,ac-0.5)}}}if(aC){aI.fillStyle="rgba(0, 255, 0, 0.5)";aI.fillRect(ak[3]*ac,ak[0]*ac,(ak[1]-ak[3]+1)*ac,(ak[2]-ak[0]+1)*ac)}return{mu:aE,occupied:al,bounds:ak,gw:ai,gh:aD,fillTextOffsetX:aA,fillTextOffsetY:ay,fillTextWidth:ag,fillTextHeight:au,fontSize:af}};var F=function F(al,ak,am,ag,af){var aj=af.length;while(aj--){var ai=al+af[aj][0];var ah=ak+af[aj][1];if(ai>=z||ah>=y||ai<0||ah<0){if(!ab.drawOutOfBound){return false}continue}if(!T[ai][ah]){return false}}return true};var j=function j(ar,aq,ai,ag,am,af,ah,ap,al,ao){var at=ai.fontSize;var ak;if(X){ak=X(ag,am,at,af,ah,ao)}else{ak=ab.color}var an;if(M){an=M(ag,am,at,ao)}else{an=ab.fontWeight}var aj;if(v){aj=v(ag,am,at,ao)}else{aj=ab.classes}m.forEach(function(ay){if(ay.getContext){var av=ay.getContext("2d");var au=ai.mu;av.save();av.scale(1/au,1/au);av.font=an+" "+(at*au).toString(10)+"px "+ab.fontFamily;av.fillStyle=ak;av.translate((ar+ai.gw/2)*ac*au,(aq+ai.gh/2)*ac*au);if(ap!==0){av.rotate(-ap)}av.textBaseline="middle";av.fillText(ag,ai.fillTextOffsetX*au,(ai.fillTextOffsetY+at*0.5)*au);av.restore()}else{var ax=document.createElement("span");var aB="";aB="rotate("+(-ap/Math.PI*180)+"deg) ";if(ai.mu!==1){aB+="translateX(-"+(ai.fillTextWidth/4)+"px) "+"scale("+(1/ai.mu)+")"}var aw={position:"absolute",display:"block",font:an+" "+(at*ai.mu)+"px "+ab.fontFamily,left:((ar+ai.gw/2)*ac+ai.fillTextOffsetX)+"px",top:((aq+ai.gh/2)*ac+ai.fillTextOffsetY)+"px",width:ai.fillTextWidth+"px",height:ai.fillTextHeight+"px",lineHeight:at+"px",whiteSpace:"nowrap",transform:aB,webkitTransform:aB,msTransform:aB,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};if(ak){aw.color=ak}ax.textContent=ag;for(var aA in aw){ax.style[aA]=aw[aA]}if(al){for(var az in al){ax.setAttribute(az,al[az])}}if(aj){ax.className+=aj}ay.appendChild(ax)}})};var p=function p(af,ak,aj,ai,ah){if(af>=z||ak>=y||af<0||ak<0){return}T[af][ak]=false;if(aj){var ag=m[0].getContext("2d");ag.fillRect(af*ac,ak*ac,V,V)}if(o){A[af][ak]={item:ah,dimension:ai}}};var ad=function ad(aq,ao,at,al,ah,ar){var ag=ah.occupied;var ak=ab.drawMask;var ap;if(ak){ap=m[0].getContext("2d");ap.save();ap.fillStyle=ab.maskColor}var ai;if(o){var af=ah.bounds;ai={x:(aq+af[3])*ac,y:(ao+af[0])*ac,w:(af[1]-af[3]+1)*ac,h:(af[2]-af[0]+1)*ac}
}var aj=ag.length;while(aj--){var an=aq+ag[aj][0];var am=ao+ag[aj][1];if(an>=z||am>=y||an<0||am<0){continue}p(an,am,ak,ai,ar)}if(ak){ap.restore()}};var H=function H(aq){var ah,al,aj;if(Array.isArray(aq)){ah=aq[0];al=aq[1]}else{ah=aq.word;al=aq.weight;aj=aq.attributes}var ao=B();var an=f(aq);var ai=q(ah,al,ao,an);if(!ai){return false}if(K()){return false}if(!ab.drawOutOfBound&&!ab.shrinkToFit){var ag=ai.bounds;if((ag[1]-ag[3]+1)>z||(ag[2]-ag[0]+1)>y){return false}}var af=N+1;var am=function(at){var av=Math.floor(at[0]-ai.gw/2);var au=Math.floor(at[1]-ai.gh/2);var aw=ai.gw;var ar=ai.gh;if(!F(av,au,aw,ar,ai.occupied)){return false}j(av,au,ai,ah,al,(N-af),at[2],ao,aj,an);ad(av,au,aw,ar,ai,aq);return true};while(af--){var ap=S(N-af);if(ab.shuffle){ap=[].concat(ap);e(ap)}var ak=ap.some(am);if(ak){return true}}if(ab.shrinkToFit){if(Array.isArray(aq)){aq[1]=aq[1]*3/4}else{aq.weight=aq.weight*3/4}return H(aq)}return false};var J=function J(ah,af,ag){if(af){return !m.some(function(ai){var aj=new CustomEvent(ah,{detail:ag||{}});return !ai.dispatchEvent(aj)},this)}else{m.forEach(function(ai){var aj=new CustomEvent(ah,{detail:ag||{}});ai.dispatchEvent(aj)},this)}};var D=function D(){var ah=m[0];if(ah.getContext){z=Math.ceil(ah.width/ac);y=Math.ceil(ah.height/ac)}else{var at=ah.getBoundingClientRect();z=Math.ceil(at.width/ac);y=Math.ceil(at.height/ac)}if(!J("wordcloudstart",true)){return}k=(ab.origin)?[ab.origin[0]/ac,ab.origin[1]/ac]:[z/2,y/2];N=Math.floor(Math.sqrt(z*z+y*y));T=[];var aw,av,an;if(!ah.getContext||ab.clearCanvas){m.forEach(function(ay){if(ay.getContext){var ax=ay.getContext("2d");ax.fillStyle=ab.backgroundColor;ax.clearRect(0,0,z*(ac+1),y*(ac+1));ax.fillRect(0,0,z*(ac+1),y*(ac+1))}else{ay.textContent="";ay.style.backgroundColor=ab.backgroundColor;ay.style.position="relative"}});aw=z;while(aw--){T[aw]=[];av=y;while(av--){T[aw][av]=true}}}else{var al=document.createElement("canvas").getContext("2d");al.fillStyle=ab.backgroundColor;al.fillRect(0,0,1,1);var aq=al.getImageData(0,0,1,1).data;var af=ah.getContext("2d").getImageData(0,0,z*ac,y*ac).data;aw=z;var au,ar;while(aw--){T[aw]=[];av=y;while(av--){ar=ac;singleGridLoop:while(ar--){au=ac;while(au--){an=4;while(an--){if(af[((av*ac+ar)*z*ac+(aw*ac+au))*4+an]!==aq[an]){T[aw][av]=false;break singleGridLoop}}}}if(T[aw][av]!==false){T[aw][av]=true}}}af=al=aq=undefined}if(ab.hover||ab.click){o=true;aw=z+1;while(aw--){A[aw]=[]}if(ab.hover){ah.addEventListener("mousemove",n)}if(ab.click){ah.addEventListener("click",E);ah.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"}ah.addEventListener("wordcloudstart",function aj(){ah.removeEventListener("wordcloudstart",aj);ah.removeEventListener("mousemove",n);ah.removeEventListener("click",E);G=undefined})}an=0;var am,ap;if(ab.wait!==0){am=window.setTimeout;ap=window.clearTimeout}else{am=window.setImmediate;ap=window.clearImmediate}var ak=function ak(ax,ay){m.forEach(function(az){az.addEventListener(ax,ay)},this)};var ai=function ai(ax,ay){m.forEach(function(az){az.removeEventListener(ax,ay)},this)};var ag=function ag(){ai("wordcloudstart",ag);ap(a[l])};ak("wordcloudstart",ag);a[l]=am(function ao(){if(an>=ab.list.length){ap(a[l]);J("wordcloudstop",false);ai("wordcloudstart",ag);delete a[l];return}U=(new Date()).getTime();var ay=H(ab.list[an]);var ax=!J("wordclouddrawn",true,{item:ab.list[an],drawn:ay});if(K()||ax){ap(a[l]);ab.abort();J("wordcloudabort",false);J("wordcloudstop",false);ai("wordcloudstart",ag);delete a[l];return}an++;a[l]=am(ao,ab.wait)},ab.wait)};D()};d.isSupported=c;d.minFontSize=h;d.stop=function g(){if(a){for(var j in a){window.clearImmediate(a[j])}}};if(typeof define==="function"&&define.amd){b.WordCloud=d;define("wordcloud",[],function(){return d})}else{if(typeof module!=="undefined"&&module.exports){module.exports=d}else{b.WordCloud=d}}})(this);